{% extends "base.html" %}

{% block title %}Hasil Scan — {{ anggota.nama }}{% endblock %}
{% block page_title %}Hasil Scan Kartu{% endblock %}

{% block content %}
<div class="section-header">
    <a href="{{ url_for('scan_page') }}" class="btn btn-secondary btn-sm">
        <i class="bi bi-arrow-left"></i> Scan Lagi
    </a>
    <span class="badge badge-{{ anggota.status_kartu|lower }}" style="font-size: 13px; padding: 8px 16px;">
        <i class="bi bi-{% if anggota.status_kartu == 'Aktif' %}check-circle-fill{% else %}exclamation-triangle-fill{% endif %}"></i>
        Kartu {{ anggota.status_kartu }}
    </span>
</div>

<!-- Success Banner -->
<div class="card mb-3" style="border-color: rgba(74, 140, 74, 0.3); background: linear-gradient(135deg, rgba(74, 140, 74, 0.08), var(--bg-card));">
    <div class="card-body" style="text-align: center; padding: 24px;">
        <i class="bi bi-check-circle-fill" style="font-size: 40px; color: #6ecc6e; display: block; margin-bottom: 8px;"></i>
        <h2 style="font-family: 'Bebas Neue', sans-serif; font-size: 24px; letter-spacing: 1px;">Kartu Teridentifikasi</h2>
        <p style="color: var(--text-muted); font-size: 13px;">Kartu Pintar berhasil dibaca dan diverifikasi</p>
    </div>
</div>

<div class="detail-grid">
    <!-- Left: Card Preview -->
    <div>
        <div class="id-card">
            <div class="id-card-header">
                <h3>KARTU PINTAR</h3>
                <p>TNI AD — Poltekkad</p>
            </div>
            <div class="id-card-body">
                <div class="id-card-photo">
                    <i class="bi bi-person-fill"></i>
                </div>
                <div class="id-card-info">
                    <div class="info-row">
                        <div class="info-label">Nama</div>
                        <div class="info-value">{{ anggota.nama }}</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">NRP</div>
                        <div class="info-value">{{ anggota.nrp }}</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">Pangkat</div>
                        <div class="info-value">{{ anggota.pangkat }}</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">Gol. Darah</div>
                        <div class="info-value">{{ anggota.golongan_darah }}</div>
                    </div>
                </div>
            </div>
            <div class="id-card-footer">
                <div class="id-card-nfc">
                    <i class="bi bi-nfc"></i>
                    <span>NFC: {{ anggota.nfc_uid }}</span>
                </div>
                <div style="width: 50px; height: 50px; background: #fff; border-radius: 4px; display: flex; align-items: center; justify-content: center; padding: 4px;">
                    <i class="bi bi-qr-code" style="font-size: 32px; color: #000;"></i>
                </div>
            </div>
        </div>

        <div class="saldo-display mt-2">
            <label>Saldo Tersedia</label>
            <div class="saldo-amount">{{ anggota.saldo|rupiah }}</div>
        </div>

        <div class="d-flex gap-2 mt-2">
            <a href="{{ url_for('anggota_detail', anggota_id=anggota.id) }}" class="btn btn-primary" style="flex:1; justify-content: center;">
                <i class="bi bi-person-badge"></i> Lihat Detail Lengkap
            </a>
        </div>
    </div>

    <!-- Right: Identity Info -->
    <div>
        <div class="card">
            <div class="card-header">
                <h2><i class="bi bi-person-badge-fill" style="color: var(--gold-400);"></i> Identitas Pemegang Kartu</h2>
            </div>
            <div class="card-body">
                <div class="detail-info-grid">
                    <div class="detail-field">
                        <label>ID Kartu</label>
                        <span>{{ anggota.id }}</span>
                    </div>
                    <div class="detail-field">
                        <label>NRP</label>
                        <span>{{ anggota.nrp }}</span>
                    </div>
                    <div class="detail-field">
                        <label>Nama Lengkap</label>
                        <span>{{ anggota.nama }}</span>
                    </div>
                    <div class="detail-field">
                        <label>Pangkat</label>
                        <span>{{ anggota.pangkat }}</span>
                    </div>
                    <div class="detail-field">
                        <label>Satuan</label>
                        <span>{{ anggota.satuan }}</span>
                    </div>
                    <div class="detail-field">
                        <label>Jabatan</label>
                        <span>{{ anggota.jabatan }}</span>
                    </div>
                    <div class="detail-field">
                        <label>Jurusan</label>
                        <span>{{ anggota.jurusan }}</span>
                    </div>
                    <div class="detail-field">
                        <label>Agama</label>
                        <span>{{ anggota.agama }}</span>
                    </div>
                    <div class="detail-field">
                        <label>Tempat, Tanggal Lahir</label>
                        <span>{{ anggota.tempat_lahir }}, {{ anggota.tanggal_lahir }}</span>
                    </div>
                    <div class="detail-field">
                        <label>Golongan Darah</label>
                        <span>{{ anggota.golongan_darah }}</span>
                    </div>
                </div>
                <div class="detail-field mt-2">
                    <label>Alamat</label>
                    <span>{{ anggota.alamat }}</span>
                </div>
            </div>
        </div>

        <!-- Location -->
        <div class="card">
            <div class="card-header">
                <h2><i class="bi bi-geo-alt-fill" style="color: var(--gold-400);"></i> Lokasi Terakhir Kartu</h2>
            </div>
            <div class="card-body">
                <div style="display: flex; align-items: center; gap: 14px;">
                    <div class="location-pin {{ anggota.status_kartu|lower }}">
                        <i class="bi bi-geo-alt-fill"></i>
                    </div>
                    <div>
                        <h4 style="font-size: 14px; color: var(--text-primary);">{{ anggota.lokasi_terakhir.lokasi }}</h4>
                        <p style="font-size: 12px; color: var(--text-muted);">
                            {{ anggota.lokasi_terakhir.waktu|datetime_format }} &bull;
                            Lat: {{ anggota.lokasi_terakhir.lat }}, Lng: {{ anggota.lokasi_terakhir.lng }}
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
